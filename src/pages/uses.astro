---
import MainLayout from "../layouts/MainLayout.astro";
---

<MainLayout title="Uses">
  <main id="main-content" role="main">
    <section class="uses-section">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">Uses</h2>
          <p class="section-subtitle">Secure Workspace Environment</p>
        </div>

        <div class="uses-grid reveal">
          <div class="tech-card tilt-card">
            <div class="scanline"></div>
            <div class="card-header">
              <span class="card-icon holo-icon">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="32"
                  height="32"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect>
                  <rect x="9" y="9" width="6" height="6"></rect>
                  <line x1="9" y1="1" x2="9" y2="4"></line>
                  <line x1="15" y1="1" x2="15" y2="4"></line>
                  <line x1="9" y1="20" x2="9" y2="23"></line>
                  <line x1="15" y1="20" x2="15" y2="23"></line>
                  <line x1="20" y1="9" x2="23" y2="9"></line>
                  <line x1="20" y1="14" x2="23" y2="14"></line>
                  <line x1="1" y1="9" x2="4" y2="9"></line>
                  <line x1="1" y1="14" x2="4" y2="14"></line>
                </svg>
              </span>
              <h3 class="encrypted-text">Hardware</h3>
            </div>

            <ul class="uses-list">
              <li>
                <span class="label encrypted-text">CPU</span>
                <span class="value encrypted-text">AMD Ryzen 9 9950X3D</span>
              </li>
              <li>
                <span class="label encrypted-text">GPU</span>
                <span class="value encrypted-text">NVIDIA RTX 5090 (32GB)</span>
              </li>
              <li>
                <span class="label encrypted-text">RAM</span>
                <span class="value encrypted-text">64GB DDR5</span>
              </li>
              <li>
                <span class="label encrypted-text">Storage</span>
                <span class="value encrypted-text">4.5TB NVMe SSD</span>
              </li>
              <li>
                <span class="label encrypted-text">OS</span>
                <span class="value encrypted-text">Windows 11 Pro</span>
              </li>
            </ul>
          </div>

          <div class="tech-card tilt-card">
            <div class="scanline"></div>
            <div class="card-header">
              <span class="card-icon holo-icon">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="32"
                  height="32"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <polyline points="4 17 10 11 4 5"></polyline>
                  <line x1="12" y1="19" x2="20" y2="19"></line>
                </svg>
              </span>
              <h3 class="encrypted-text">Software</h3>
            </div>
            <ul class="uses-list">
              <li>
                <span class="label encrypted-text">Editor</span>
                <span class="value encrypted-text">VS Code / Cursor</span>
              </li>
              <li>
                <span class="label encrypted-text">Terminal</span>
                <span class="value encrypted-text">Windows Terminal</span>
              </li>
              <li>
                <span class="label encrypted-text">Browser</span>
                <span class="value encrypted-text">Chrome / Firefox</span>
              </li>
              <li>
                <span class="label encrypted-text">Version Control</span>
                <span class="value encrypted-text">Git / GitHub</span>
              </li>
            </ul>
          </div>

          <div class="tech-card tilt-card">
            <div class="scanline"></div>
            <div class="card-header">
              <span class="card-icon holo-icon">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="32"
                  height="32"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <polygon points="12 2 2 7 12 12 22 7 12 2"></polygon>
                  <polyline points="2 17 12 22 22 17"></polyline>
                  <polyline points="2 12 12 17 22 12"></polyline>
                </svg>
              </span>
              <h3 class="encrypted-text">Tech Stack</h3>
            </div>
            <div class="tags-container">
              <span class="tag encrypted-text">Astro</span>
              <span class="tag encrypted-text">React</span>
              <span class="tag encrypted-text">TypeScript</span>
              <span class="tag encrypted-text">Tailwind</span>
              <span class="tag encrypted-text">Node.js</span>
              <span class="tag encrypted-text">Cloudflare</span>
              <span class="tag encrypted-text">Figma</span>
            </div>
          </div>
        </div>

        <p class="content-meta encrypted-text">
          Status: Secure â€¢ Encrypted Connection
        </p>
      </div>
    </section>
  </main>
</MainLayout>

<style>
  .uses-section {
    padding-bottom: 4rem;
    perspective: 1000px;
  }

  .section-subtitle {
    color: var(--color-text-muted);
    font-size: var(--text-lg);
    margin-top: 0.5rem;
    font-family: var(--font-mono);
  }

  .uses-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 2.5rem;
    margin-top: 3rem;
  }

  /* --- TECH CARD --- */
  .tech-card {
    position: relative;
    border-radius: 20px;
    padding: 2.5rem 2rem;
    background: var(--color-surface-2);
    border: 1px solid var(--glass-border);
    overflow: hidden;
    transition: box-shadow 0.3s ease;
    transform-style: preserve-3d;
  }

  :global([data-theme="light"]) .tech-card {
    background: #ffffff;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
  }

  .tech-card:hover {
    border-color: var(--color-accent-start);
    box-shadow: 0 15px 40px -10px rgba(0, 0, 0, 0.5);
  }

  :global([data-theme="light"]) .tech-card:hover {
    box-shadow: 0 15px 40px -10px rgba(0, 0, 0, 0.1);
  }

  /* --- SCANLINE EFFECT --- */
  .scanline {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      to bottom,
      transparent 50%,
      rgba(0, 0, 0, 0.2) 51%,
      transparent 51%
    );
    background-size: 100% 4px;
    pointer-events: none;
    z-index: 0;
    opacity: 0;
    transition: opacity 0.3s;
  }

  .tech-card:hover .scanline {
    opacity: 0.3;
    animation: scanline-scroll 20s linear infinite;
  }

  :global([data-theme="light"]) .scanline {
    display: none;
  }

  @keyframes scanline-scroll {
    from {
      background-position: 0 0;
    }
    to {
      background-position: 0 100%;
    }
  }

  /* --- HEADER --- */
  .card-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--glass-border);
    position: relative;
    z-index: 1;
    transform: translateZ(20px);
  }

  .card-icon {
    font-size: 2rem;
    background: var(--color-surface-1);
    width: 56px;
    height: 56px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 14px;
    border: 1px solid var(--glass-border);
    transition: all 0.4s ease; /* Smooth transition for morphing */
  }

  /* * NEW ANIMATION: HOLOGRAPHIC LEVITATION 
   * - Removes color (grayscale)
   * - Increases brightness to look like light
   * - Floats up and down
   */
  .tech-card:hover .holo-icon {
    background: rgba(0, 0, 0, 0.5); /* Darker backing */
    border-color: var(--color-accent-start);

    /* The Hologram Look: No color, just bright light */
    filter: grayscale(1) brightness(1.3)
      drop-shadow(0 0 8px var(--color-accent-start));

    /* The Float */
    animation: holo-float 3s ease-in-out infinite;
  }

  @keyframes holo-float {
    0%,
    100% {
      transform: translateY(-2px) scale(1);
      box-shadow: 0 0 15px rgba(124, 58, 237, 0.2);
    }
    50% {
      transform: translateY(-8px) scale(1.05); /* Float Up */
      box-shadow: 0 0 25px rgba(124, 58, 237, 0.6); /* Glow intensifies */
    }
  }

  :global([data-theme="light"]) .card-icon {
    background: #f3f4f6;
  }

  .card-header h3 {
    margin: 0;
    font-size: 1.5rem;
    font-weight: 700;
    font-family: var(--font-mono);
    letter-spacing: -0.03em;
    min-width: 150px;
    color: var(--color-accent-start);
  }

  /* --- LIST --- */
  .uses-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 1.25rem;
    position: relative;
    z-index: 1;
    transform: translateZ(10px);
  }

  .uses-list li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-family: var(--font-mono);
  }

  .label {
    color: var(--color-text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-size: 0.85rem;
    font-weight: 600;
  }

  .value {
    color: var(--color-text-primary);
    font-weight: 700;
    text-align: right;
    font-size: 1.1rem;
  }

  /* --- TAGS --- */
  .tags-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.85rem;
    position: relative;
    z-index: 1;
    transform: translateZ(10px);
  }

  .tag {
    background: rgba(255, 255, 255, 0.03);
    padding: 0.5rem 1.1rem;
    border-radius: 8px;
    font-family: var(--font-mono);
    font-size: 0.9rem;
    border: 1px solid var(--glass-border);
    color: var(--color-text-muted);
    transition: all 0.2s;
  }

  :global([data-theme="light"]) .tag {
    background: #f1f5f9;
  }

  .content-meta {
    text-align: center;
    margin-top: 4rem;
    color: var(--color-text-muted);
    font-family: var(--font-mono);
    font-size: 0.8rem;
    opacity: 0.5;
  }

  @media (max-width: 768px) {
    .uses-grid {
      grid-template-columns: 1fr;
    }
    .tech-card {
      transform: none !important;
    }
    .card-header,
    .uses-list,
    .tags-container {
      transform: none !important;
    }
  }
</style>

<script>
  // ---------------------------------------------------------
  // 1. MATRIX DECRYPTION
  // ---------------------------------------------------------
  const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%&";

  class EncryptedText {
    constructor(el) {
      this.el = el;
      this.originalText = el.innerText;
      this.interval = null;
      this.activeResolve = null;
      this.isRevealed = false;
      this.scramble();
    }

    scramble() {
      if (this.interval) clearInterval(this.interval);
      if (this.activeResolve) {
        this.activeResolve();
        this.activeResolve = null;
      }
      const length = this.originalText.length;
      let randomText = "";
      for (let i = 0; i < length; i++) {
        if (this.originalText[i] === " ") randomText += " ";
        else randomText += chars[Math.floor(Math.random() * chars.length)];
      }
      this.el.innerText = randomText;
      this.isRevealed = false;
    }

    reveal() {
      if (this.isRevealed) return Promise.resolve();

      return new Promise((resolve) => {
        this.activeResolve = resolve;
        this.isRevealed = true;

        let iteration = 0;
        clearInterval(this.interval);

        this.interval = setInterval(() => {
          this.el.innerText = this.originalText
            .split("")
            .map((letter, index) => {
              if (index < iteration) {
                return this.originalText[index];
              }
              if (letter === " ") return " ";
              return chars[Math.floor(Math.random() * chars.length)];
            })
            .join("");

          if (iteration >= this.originalText.length) {
            clearInterval(this.interval);
            if (this.activeResolve) {
              this.activeResolve();
              this.activeResolve = null;
            }
          }

          iteration += 1 / 2;
        }, 30);
      });
    }
  }

  // Initialize Decryptors
  const encryptedElements = [];
  document.querySelectorAll(".encrypted-text").forEach((el) => {
    // @ts-ignore
    encryptedElements.push({
      controller: new EncryptedText(el),
      element: el,
    });
  });

  // ---------------------------------------------------------
  // 2. CARD INTERACTION (TILT + SEQUENTIAL DECRYPT)
  // ---------------------------------------------------------
  document.querySelectorAll(".tech-card").forEach((card) => {
    // @ts-ignore
    card.isHovering = false;

    // -- 3D Tilt --
    card.addEventListener("mousemove", (e) => {
      // @ts-ignore
      if (window.innerWidth < 768) return;

      // @ts-ignore
      const rect = card.getBoundingClientRect();
      // @ts-ignore
      const x = e.clientX - rect.left;
      // @ts-ignore
      const y = e.clientY - rect.top;

      const centerX = rect.width / 2;
      const centerY = rect.height / 2;

      const rotateX = ((y - centerY) / centerY) * -5;
      const rotateY = ((x - centerX) / centerX) * 5;

      // @ts-ignore
      card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale3d(1.02, 1.02, 1.02)`;
    });

    // -- Sequential Decrypt --
    card.addEventListener("mouseenter", async () => {
      // @ts-ignore
      card.isHovering = true;

      const targets = card.querySelectorAll(".encrypted-text");
      for (const target of targets) {
        // @ts-ignore
        if (!card.isHovering) break;
        const wrapper = encryptedElements.find((w) => w.element === target);
        if (wrapper) await wrapper.controller.reveal();
      }
    });

    // -- Reset --
    card.addEventListener("mouseleave", () => {
      // @ts-ignore
      card.isHovering = false;

      // Reset Tilt
      // @ts-ignore
      card.style.transform =
        "perspective(1000px) rotateX(0) rotateY(0) scale3d(1, 1, 1)";

      // Reset Text
      const targets = card.querySelectorAll(".encrypted-text");
      targets.forEach((target) => {
        const wrapper = encryptedElements.find((w) => w.element === target);
        if (wrapper) wrapper.controller.scramble();
      });
    });
  });
</script>
